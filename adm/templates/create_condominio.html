{% extends 'base_login.html' %}
{% load static %}

{% block menu %}
<nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">
            <div class="icon-container">
                <img src="{% static 'img/icon.png' %}" alt="Logo" class="navbar img.icon-img" style="max-width: 65%; height: 65px; margin-left: 20px; margin-top: 15px;">
            </div>
        </a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav custom-nav-link">
                <li class="nav-item">
                    <a class="nav-link text-center" href="{% url 'menu_add' %}" style="display: flex; flex-direction: column; align-items: center;">
                        <img src="{% static 'img/voltar.png' %}" alt="voltar" style="width: 30px; height: 30px; margin-left: 100px; filter: invert(1);">
                        <span style="margin-top: 5px;margin-left: 100px;">Retornar</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<div class="icon-container" style="display: flex; align-items: center; justify-content: center; margin-bottom: -40px;">
</div>
<br>
<br>
<br>
{% endblock %}

{% block content %}
<br>

<h2 style="flex-grow: 1; text-align: center; margin: 0;">Adicionar Condomínio</h2> <!-- Título centralizado -->

<div class="container">
    <form method="post" id="condominium-form">
       <input type="hidden" name="status" value="1">  <!-- Campo oculto para status -->

        {% csrf_token %}
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_nome_condominio">Nome do Condomínio:</label>
                    {{ form.nome_condominio }}
                    <div class="error-message">{{ form.nome_condominio.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_cnpj">CNPJ:</label>
                    {{ form.cnpj }}
                    <div class="error-message">{{ form.cnpj.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_data_condominio">Data do Condomínio:</label>
                    {{ form.data_condominio }}
                    <div class="error-message">{{ form.data_condominio.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_cep">CEP:</label>
                    {{ form.cep }}
                    <div class="error-message">{{ form.cep.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_logradouro">Logradouro:</label>
                    {{ form.logradouro }}
                    <div class="error-message">{{ form.logradouro.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_numero">Número:</label>
                    {{ form.numero }}
                    <div class="error-message">{{ form.numero.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_complemento">Complemento:</label>
                    {{ form.complemento }}
                    <div class="error-message">{{ form.complemento.errors }}</div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_bairro">Bairro:</label>
                    {{ form.bairro }}
                    <div class="error-message">{{ form.bairro.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_cidade">Cidade:</label>
                    {{ form.cidade }}
                    <div class="error-message">{{ form.cidade.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_uf">UF:</label>
                    {{ form.uf }}
                    <div class="error-message">{{ form.uf.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_ramal_condominio">Ramal do Condomínio:</label>
                    {{ form.ramal_condominio }}
                    <div class="error-message">{{ form.ramal_condominio.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_ramal_interno">Ramal Interno:</label>
                    {{ form.ramal_interno }}
                    <div class="error-message">{{ form.ramal_interno.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_telefone">Telefone:</label>
                    {{ form.telefone }}
                    <div class="error-message">{{ form.telefone.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_internet">Internet:</label>
                    {{ form.internet }}
                    <div class="error-message">{{ form.internet.errors }}</div>
                </div>
            </div>
        </div>

        <!-- Campos adicionais (continuar assim até o final do formulário) -->
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_unidade">Unidade:</label>
                    {{ form.unidade }}
                    <div class="error-message">{{ form.unidade.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_suporteunidade">Suporte Unidade:</label>
                    {{ form.suporteunidade }}
                    <div class="error-message">{{ form.suporteunidade.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_entregadores_norma">Entregadores Norma:</label>
                    {{ form.entregadores_norma }}
                    <div class="error-message">{{ form.entregadores_norma.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_prestadores_norma">Prestadores Norma:</label>
                    {{ form.prestadores_norma }}
                    <div class="error-message">{{ form.prestadores_norma.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_reservas_norma">Reservas Norma:</label>
                    {{ form.reservas_norma }}
                    <div class="error-message">{{ form.reservas_norma.errors }}</div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_mudancas_norma">Mudanças Norma:</label>
                    {{ form.mudancas_norma }}
                    <div class="error-message">{{ form.mudancas_norma.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_responsavel_tattica">Responsável Tattica:</label>
                    {{ form.responsavel_tattica }}
                    <div class="error-message">{{ form.responsavel_tattica.errors }}</div>
                </div>

                <div class="form-group">
                    <label for="id_norma_observacao">Norma Observação:</label>
                    {{ form.norma_observacao }}
                    <div class="error-message">{{ form.norma_observacao.errors }}</div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="id_website">Website:</label>
                        {{ form.website }}
                        <div class="error-message">{{ form.website.errors }}</div>
                    </div>

                    <div class="form-group">
                        <label for="id_website_agendamento">Website Agendamento:</label>
                        {{ form.website_agendamento }}
                        <div class="error-message">{{ form.website_agendamento.errors }}</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="id_financeiro_responsavel">Responsável Financeiro:</label>
                        {{ form.financeiro_responsavel }}
                        <div class="error-message">{{ form.financeiro_responsavel.errors }}</div>
                    </div>

                    <div class="form-group">
                        <label for="id_financeiro_email">Email Financeiro:</label>
                        {{ form.financeiro_email }}
                        <div class="error-message">{{ form.financeiro_email.errors }}</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-groupr">
            <br>
            <button type="submit" class="btn btn-primary ">Cadastrar</button>
        </div>
        <br>
        <br>
        <br>
    </form>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
<script>
    $(document).ready(function(){
        // Aplica as máscaras nos campos
        $('#id_cep').mask('00000-000'); // Máscara para CEP
        $('#id_cnpj').mask('00.000.000/0000-00'); // Máscara para CNPJ
        $('#id_telefone').mask('(00) 0 0000-0000'); // Máscara para telefone
    });

    document.addEventListener('DOMContentLoaded', function() {
        const cepField = document.getElementById('id_cep');

        // Quando o campo CEP perder o foco, faz a requisição para a API ViaCEP
        cepField.addEventListener('blur', function() {
            const cep = cepField.value.replace(/\D/g, '');

            if (cep.length === 8) { // Verifica se o CEP tem 8 dígitos
                fetch(`https://viacep.com.br/ws/${cep}/json/`) // Corrigido: uso de crases para interpolação
                .then(response => response.json())
                .then(data => {
                    if (!('erro' in data)) {
                        document.getElementById('id_logradouro').value = data.logradouro;
                        document.getElementById('id_bairro').value = data.bairro;
                        document.getElementById('id_cidade').value = data.localidade;
                        document.getElementById('id_uf').value = data.uf;
                    } else {
                        alert('CEP não encontrado.');
                    }
                })
                .catch(error => {
                    console.error('Erro ao buscar o CEP:', error);
                    alert('Erro ao buscar o CEP.');
                });
            }
        });
    });
</script>
{% endblock %}
